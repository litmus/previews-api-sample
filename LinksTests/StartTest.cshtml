@using Litmus.Apis.Previews
@using Litmus.Apis.Previews.Models
@using Microsoft.Ajax.Utilities
@{
    Layout = "~/_SiteLayout.cshtml";
    Page.Title = "Start Links Test";

    var litmusPreviewsApi = new PreviewsApi(AuthHelper.ApiUsername, AuthHelper.ApiPassword);
    var returnedTest = new LinksTest();
    
    if (IsPost)
    {
        var html = File.ReadAllText(Server.MapPath("Example.html"));

        returnedTest = litmusPreviewsApi.CreateLinksTest(html);
    }
    
}

<h2>Starting Tests</h2>
<p>Starting tests is one of the most important things you'll want to be able to do.</p>

<form method="POST">
    <input type="submit" value="Submit a Test"/>
</form>

@if (!returnedTest.Error && IsPost){
    <text>Test created!  Click <a href="FetchResults?test=@returnedTest.Id">here</a> to start polling for results for this test.<br /></text>
}

